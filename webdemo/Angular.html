<!DOCTYPE html>
<html ng-app="ptcApp">
<head>
    <title></title>
    <meta charset="utf-8" />
    <link href="Content/bootstrap.min.css" rel="stylesheet" />
    <script src="Scripts/jquery-1.9.1.min.js"></script>
    <script src="Scripts/bootstrap.min.js"></script>
    <script src="Scripts/angular.min.js"></script>
    <script src="Scripts/app.js"></script>
    <!--<script src="Scripts/SessionLogic.js"></script>-->
</head>
<body ng-controller="PTCController">

    <!-- Angular needs to take over validation, so we add novalidate to the form to keep browsers from doing validation -->
    <form name="productForm" novalidate>

        <div class="container">
            <!-- ** PAGE TITLE AREA ** -->
            <div class="row">
                <div class="col-sm-6">
                    <h2>Html WebApi and Angular</h2>
                </div>
            </div>

            <!-- ** BEGIN MESSAGE AREA ** -->
            <div ng-show="uiState.isMessageAreaVisible" class="row">
                <div class="alert alert-danger" role="alert">
                    <!--<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>-->
                    <ul>
                        <li ng-repeat="msg in uiState.messages">
                            {{msg.message}}
                        </li>

                        <!--show validation error messages-->
                        <li ng-show="productForm.ProductName.$error.required">Product Name is Required.</li>
                        <li ng-show="!productForm.ProductName.$valid">Product Name must have more than 4 characters and less than 150.</li>

                        <li ng-show="productForm.IntroductionDate.$error.required">Introduction Date is Required.</li>
                        <li ng-show="!productForm.IntroductionDate.$valid">Invalid Introduction Date.</li>

                        <li ng-show="productForm.Url.$error.required">Url is Required.</li>

                        <li ng-show="productForm.Price.$error.required">Price is Required.</li>
                        <li ng-show="!productForm.Price.$valid">Price must be btween $0.01 and $9.999.</li>

                    </ul>
                    <!--<strong>Warning!</strong> Better check yourself, you're not looking too good.-->
                </div>
            </div>

            <!-- ** BEGIN LOADING AREA ** -->
            <div ng-show="uiState.isLoading" class="row">
                <div class="alert alert-info" role="alert">
                    <i class="glyphicon glyphicon-cog"></i> LOADING...
                </div>
            </div>

            <!-- ** BEGIN SEARCH AREA ** -->
            <div ng-show="uiState.isSearchAreaVisible" class="panel panel-primary">
                <div class="panel-heading"></div>
                <div class="panel-body">
                    <div class="form-horizontal">
                        <label for="productSearch">Product Search</label>
                        <input class="form-control input-sm" id="productSearch" />
                    </div>

                </div>
                <div class="panel-footer">
                    <button type="button" id="searchButton" class="btn btn-sm btn-primary" ng-click="searchClick()"><i class="glyphicon glyphicon-search"></i> Search</button>
                    <button type="button" id="resetButton" class="btn btn-sm btn-primary" ng-click="cancelClick()"><i class="glyphicon glyphicon-refresh"></i> Reset</button>
                    <button type="button" id="addButton" class="btn btn-sm btn-success" ng-click="addClick()"><i class="glyphicon glyphicon-plus"></i> Add</button>
                </div>
            </div>

            <!-- ** BEGIN LIST AREA ** -->
            <div ng-show="uiState.isListAreaVisible" class="table-responsive">
                <table id="productTable" class="table table-bordered table-condensed table-striped">
                    <thead>
                        <tr>
                            <th>Edit</th>
                            <th>Product Name</th>
                            <th>Introduction Date</th>
                            <th>URL</th>
                            <th>Price</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr ng-repeat="product in products">
                            <td class='pdsa-action-button-column'>
                                <a href='#' class="btn btn-default btn-sm"  title="Edit ID:{{product.ProductId}}" ng-click="editClick(product.ProductId)"><i class="glyphicon glyphicon-edit"></i></a>
                            </td>
                            <td>{{product.ProductName}}</td>
                            <td>{{product.IntroductionDate | date}}</td>
                            <td>{{product.Url}}</td>
                            <td>{{product.Price | currency : "$"}}</td>
                            <td class='pdsa-action-button-column'>
                                <a href='#' class="btn btn-warning btn-sm"  title="Delete ID:{{product.ProductId}}" ng-click="deleteClick(product.ProductId)"><i class="glyphicon glyphicon-trash"></i></a>
                            </td>
                        </tr>
                    </tbody>


                </table>
            </div>

            <!-- ** BEGIN DETAIL AREA ** -->
            <div ng-show="uiState.isDetailAreaVisible" class="panel panel-primary">

                <div class="panel-heading">
                    Product Information
                </div>
                <div class="panel-body">
                    <div class="form-group">
                        <label for="ProductName">Product Name</label>
                        <!-- angular validation uses the 'name' and value to determine if is valid. so make id and name the same -->
                        <input type="text" id="ProductName" name="ProductName"
                               required
                               ng-minlength="5"
                               ng-maxlength="150" class="form-control" ng-model="product.ProductName" />

                    </div>
                    <div class="form-group">
                        <label for="IntroductionDate">Introduction Date</label>
                        <input type="text" id="IntroductionDate" name="IntroductionDate"
                               required
                               class="form-control" ng-model="product.IntroductionDate" />
                    </div>
                    <div class="form-group">
                        <label for="Url">URL</label>
                        <input type="text" id="Url" name="Url"
                               required
                               class="form-control" ng-model="product.Url" />
                    </div>
                    <div class="form-group">
                        <label for="Price">Price</label>
                        <input type="number" id="Price" name="Price"
                               required
                               min="0.01" max="9999.99"
                               class="form-control" ng-model="product.Price" />
                    </div>
                </div>
                <input type="hidden" id="ProductId" name="ProductId" value="{{product.ProductId}}" />
                <div class="panel-footer">
                    <div class="row">
                        <div class="col-xs-12">
                            <button type="button" id="updateButton" class="btn btn-primary btn-sm" ng-click="saveClick()"><i class="glyphicon glyphicon-floppy-disk"></i> Save</button>

                            <button type="button" id="cancelButton" class="btn btn-primary btn-sm" ng-click="cancelClick()"><i class="glyphicon glyphicon-remove-circle"></i> Cancel</button>
                        </div>
                    </div>
                </div>
            </div>



            <!--Page Selection AREA-->
            <div class="row">
                <div class="col-xs-6 text-center">
                    <a href="Default.html" class="btn btn-sm btn-default">JQuery Version</a>
                </div>
                <div class="col-xs-6 text-center">
                    <a href="Angular.html" class="btn btn-sm btn-default">Angular Version</a>
                </div>
            </div>
        </div>
    </form>
    <script type="text/javascript">


        // create an angular application scope
        (function () {
            // 'use strict';

            angular.module('ptcApp', []).controller('PTCController', PTCController)
            // add a custom url directive
            .directive('urlMicrosoft', function () {
                return {
                    require: 'ngModel',
                    link: function (scope, element, attributes, ngModel) {
                        ngModel.$validators.microsoft = function (value) {
                            if (value) {
                                return value.indexOf("microsoft") === -1;
                            }
                        }
                    }
                }
            });
        })();


    </script>
</body>
</html>